<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="../../assets/css/style.css" />
    <link
      rel="shortcut icon"
      href="../../assets/favicon/favicon.png"
      type="image/x-icon"
    />
    <title>Building GitHub Actions</title>
  </head>
  <body>
    <div class="floating-div">
      <header>
        <div class="btn">
          <a href="../081/executable_files.html" class="previous">
            &laquo; Previous
          </a>
        </div>
        <div class="title">
          <h1>Building GitHub Actions</h1>
        </div>
        <div class="btn">
          <a href="../083/the_core_package.html" class="next"> Next &raquo; </a>
        </div>
      </header>
    </div>
    <main>
      <section>
        <!-- Building GitHub actions -->
        <div class="row">
          <div class="left-col">
            <p>
              We can create our own actions to automate our steps. Public
              actions require their own dedicated repository. Private actions
              can be built in our repository. Actions must be written using
              JavaScript. If we need to write the Action in a different
              language, we need to run them in Docker containers. They have the
              benefit of being consistent (since they run in a controlled
              environment defined in the Docker image), but they have the draw
              side of being slower (since the image needs to be deployed to the
              virtual machine).
            </p>
          </div>
          <div class="right-col">
            <img
              src="building_github_actions_01.png"
              alt="Building GitHub Actions 1"
              class="vscode-img"
            />
          </div>
        </div>
        <!-- JavaScript Actions -->
        <div class="example"></div>
        <div class="row">
          <div class="left-col">
            <img
              src="building_github_actions_02.png"
              alt="Building GitHub Actions 2"
              class="vscode-img"
            />
          </div>
          <div class="right-col">
            <p>
              We place actions in the
              <span class="inline-code">.github/actions</span> directory. Each
              action should have its own sub-directory.
            </p>
            <br />
            <p>
              Each action requires an <em>action.yml</em> file. In this file
              we'll declare the <em>name</em>, <em>author</em>, and
              <em>description</em> of the action. Next we can add objects to the
              <em>inputs</em> and <em>outputs</em> keywords. Each elements of
              the <em>inputs</em> object is itself an object too, with a
              <em>description</em>, <em>required</em> flag, and a
              <em>default</em> value. Each element of the outputs object takes a
              <em>description</em>.
            </p>
            <br />
            <p>
              Below that we need to include the <em>runs</em> keyword. In it we
              specify the version of node in the <em>using</em> keyword, and the
              location of the file with the action in the <em>main</em> keyword.
            </p>
            <br />
            <p>
              GitHub provides a
              <a href="https://github.com/actions/toolkit" class="here"
                >toolkit</a
              >
              for building actions that we can use.
            </p>
          </div>
        </div>
        <br />
        <div class="row">
          <div class="left-col">
            <p>
              To include this action in a workflow, first we'll need to checkout
              the repository and then pass the action path to the
              <em>uses</em> keyword.
            </p>
            <br />
            <p>
              When our actions use external packages we need to compile our code
              so that the packages are available in the virtual machine. To do
              this, we can use the <em>vercel/ncc</em> package. To install it
              locally we run
              <span class="inline-code">npm i -D @vercel/ncc</span>. Once
              installed we can use it by running
            </p>
            <div class="code">
              npx ncc build path/to/file.js -o path/to/output/dist
            </div>
            <p>
              Once the <i>dist</i> is generated we just have to update the
              <em>main</em> keyword in our workflow so that it points to it (for
              example <span class="inline-code">main: 'dist/index.js'</span>).
            </p>
          </div>
          <div class="right-col">
            <img
              src="building_github_actions_03.png"
              alt="Building GitHub Actions 3"
              class="vscode-img"
            />
          </div>
        </div>
      </section>
    </main>
    <footer>
      <a class="go-home" href="../../index.html"><i class="fas fa-home"></i></a>
    </footer>
    <script
      src="https://kit.fontawesome.com/994cc6cf8e.js"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
